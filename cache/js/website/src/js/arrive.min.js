const C=[];let E=null;function T(A){return E=E||(function(m,k,d){"use strict";function g(a,r,n){s.addMethod(r,n,a.unbindEvent),s.addMethod(r,n,a.unbindEventWithSelectorOrCallback),s.addMethod(r,n,a.unbindEventWithSelectorAndCallback)}function b(a){a.arrive=h.bindEvent,g(h,a,"unbindArrive"),a.leave=v.bindEvent,g(v,a,"unbindLeave")}if(m.MutationObserver&&typeof HTMLElement<"u"){var L=0,s=(function(){var a=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(r,n){return r instanceof HTMLElement&&(n instanceof HTMLElement?n==r:a.call(r,n))},addMethod:function(r,n,i){var c=r[n];r[n]=function(){return i.length==arguments.length?i.apply(this,arguments):typeof c=="function"?c.apply(this,arguments):d}},callCallbacks:function(r,n){n&&n.options.onceOnly&&n.firedElems.length==1&&(r=[r[0]]);for(var i,c=0;i=r[c];c++)i&&i.callback&&i.callback.call(i.elem,i.elem);n&&n.options.onceOnly&&n.firedElems.length==1&&n.me.unbindEventWithSelectorAndCallback.call(n.target,n.selector,n.callback)},checkChildNodesRecursively:function(r,n,i,c){for(var t,e=0;t=r[e];e++)i(t,n,c)&&c.push({callback:n.callback,elem:t}),t.childNodes.length>0&&s.checkChildNodesRecursively(t.childNodes,n,i,c)},mergeArrays:function(r,n){var i,c={};for(i in r)r.hasOwnProperty(i)&&(c[i]=r[i]);for(i in n)n.hasOwnProperty(i)&&(c[i]=n[i]);return c},toElementsArray:function(r){return d===r||typeof r.length=="number"&&r!==m||(r=[r]),r}}})(),O=(function(){var a=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return a.prototype.addEvent=function(r,n,i,c){var t={target:r,selector:n,options:i,callback:c,firedElems:[]};return this._beforeAdding&&this._beforeAdding(t),this._eventsBucket.push(t),t},a.prototype.removeEvent=function(r){for(var n,i=this._eventsBucket.length-1;n=this._eventsBucket[i];i--)if(r(n)){this._beforeRemoving&&this._beforeRemoving(n);var c=this._eventsBucket.splice(i,1);c&&c.length&&(c[0].callback=null)}},a.prototype.beforeAdding=function(r){this._beforeAdding=r},a.prototype.beforeRemoving=function(r){this._beforeRemoving=r},a})(),M=function(a,r){var n=new O,i=this,c={fireOnAttributesModification:!1};return n.beforeAdding(function(t){var e,o=t.target;(o===m.document||o===m)&&(o=document.getElementsByTagName("html")[0]),e=new MutationObserver(function(l){r.call(this,l,t)});var u=a(t.options);e.observe(o,u),t.observer=e,t.me=i}),n.beforeRemoving(function(t){t.observer.disconnect()}),this.bindEvent=function(t,e,o){e=s.mergeArrays(c,e);for(var u=s.toElementsArray(this),l=0;l<u.length;l++)n.addEvent(u[l],t,e,o);return this},this.unbindEvent=function(){var t=s.toElementsArray(this);return n.removeEvent(function(e){for(var o=0;o<t.length;o++)if(this===d||e.target===t[o])return!0;return!1}),this},this.unbindEventWithSelectorOrCallback=function(t){var e,o=s.toElementsArray(this),u=t;e=typeof t=="function"?function(l){for(var f=0;f<o.length;f++)if((this===d||l.target===o[f])&&l.callback===u)return!0;return!1}:function(l){for(var f=0;f<o.length;f++)if((this===d||l.target===o[f])&&l.selector===t)return!0;return!1},n.removeEvent(e)},this.unbindEventWithSelectorAndCallback=function(t,e){var o=s.toElementsArray(this);n.removeEvent(function(u){for(var l=0;l<o.length;l++)if((this===d||u.target===o[l])&&u.selector===t&&u.callback===e)return!0;return!1})},this},S=function(){function a(t){var e={attributes:!1,childList:!0,subtree:!0};return t.fireOnAttributesModification&&(e.attributes=!0),e}function r(t,e){t.forEach(function(o){var u=o.addedNodes,l=o.target,f=[];u!==null&&u.length>0?s.checkChildNodesRecursively(u,e,n,f):o.type==="attributes"&&n(l,e,f)&&f.push({callback:e.callback,elem:l}),s.callCallbacks(f,e)})}function n(t,e){return s.matchesSelector(t,e.selector)&&(t._id===d&&(t._id=L++),e.firedElems.indexOf(t._id)==-1)?(e.firedElems.push(t._id),!0):!1}var i={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};h=new M(a,r);var c=h.bindEvent;return h.bindEvent=function(t,e,o){e&&(d===o?(o=e,e=i):e=s.mergeArrays(i,e)),e.selfUnbind&&C.push({callback:o,target:this});var u=s.toElementsArray(this);if(e.existing){for(var l=[],f=0;f<u.length;f++)for(var _=u[f].querySelectorAll(t),p=0;p<_.length;p++)l.push({callback:o,elem:_[p]});if(e.onceOnly&&l.length)return o.call(l[0].elem,l[0].elem);setTimeout(s.callCallbacks,1,l)}return c.call(this,t,e,o),this},h},w=function(){function a(){var t={childList:!0,subtree:!0};return t}function r(t,e){t.forEach(function(o){var u=o.removedNodes,l=[];u!==null&&u.length>0&&s.checkChildNodesRecursively(u,e,n,l),s.callCallbacks(l,e)})}function n(t,e){return s.matchesSelector(t,e.selector)}var i={};v=new M(a,r);var c=v.bindEvent;return v.bindEvent=function(t,e,o){return d===o?(o=e,e=i):e=s.mergeArrays(i,e),c.call(this,t,e,o),this},v},h=new S,v=new w;k&&b(k.fn),b(HTMLElement.prototype),b(NodeList.prototype),b(HTMLCollection.prototype),b(HTMLDocument.prototype),b(Window.prototype);var y={};return g(h,y,"unbindAllArrive"),g(v,y,"unbindAllLeave"),y}})(window,typeof jQuery>"u"?null:jQuery,void 0),A&&(A.arrive=document.arrive.bind(document)),E}export default T;export{C as arrivePageSelfUnbindCallbacksOnPageUnload};
